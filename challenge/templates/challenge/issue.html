{% extends "challenge/base.html" %}
{% load staticfiles %}
{% load thumbnail %}


{% block main %}

<div class="col-xl-8 col-lg-8 col-md-10 col-sm-12">

<div class="breadcrumbs"><a href="/">Home > </a><a href="{% url 'all_issues' %}"> Issues ></a> {{issue.name}}</div>
<hr>

<h2>{{ issue.name }}</h2>

<div>

    {% thumbnail issue.image "300x300" crop="center" as im %}
                    <img src="{{ im.url }}" width="{{ im.width }}" height="{{ im.height }}">
    {% endthumbnail %}
    <hr>
    issue.summary
    <hr>
    {{issue.description}}
    <hr>
    <ul>
        <li>Scope: {{issue.scope}}</li>
        <li>Status: {{issue.status}}</li>
        <li>Date Created: {{issue.date_created}}</li>
    </ul>
    <hr>

<h4>Projects:</h4>
<div class="card-columns">

{% for project in projects %}
    <div class="card">
        {% thumbnail project.image "300x300" crop="center" as im %}
            <img class="card-image-top" src="{{ im.url }}" width="{{ im.width }}" height="{{ im.height }}">{% empty %} 
        {% endthumbnail %}
        <div class="card-block">
            <h4 class="card-title">{{project.name}} </h4>
            <p class="card-text">{{ project.short_text }}</p>
            <a href="{% url 'project' project_slug=project.slug %}" class="btn btn-primary">See Project</a>
            {% if project.creator == user %}
                <a class="btn btn-danger" href="{% url 'project_form' pk=project.pk %}">Remove Project</a>
            {% endif %}
        </div>
    </div>
{% endfor %}

</div>
<hr>
    <h4>Stories:</h4> 
       <div class="card-columns">

{% for story in stories %}
    <div class="card">
        {% thumbnail story.image "300x300" crop="center" as im %}
            <img class="card-image-top" src="{{ im.url }}" width="{{ im.width }}" height="{{ im.height }}">{% empty %} 
        {% endthumbnail %}
        <div class="card-block">
            <h4 class="card-title">{{story.name}} </h4>
            <p class="card-text">{{ story.impact_statement }}</p>
            <hr>
            <p class="card-text">{{ story.priority }} - {{ story.rating }} - {{ story.followers.count }}</p>
            <a href="#" class="btn btn-primary">Follow</a>
        </div>
    </div>
{% endfor %}

</div>
    <hr>

{% if issue.creator == user %}
<a class="btn btn-warning" href="{% url 'issue_form' pk=issue.pk %}">Edit Issue</a>
{% endif %}

{% if user.is_authenticated %}
<a class="btn btn-primary" href="{% url 'add_story' issue_pk=issue.pk %}">Add a Story</a>
<a class="btn btn-primary" href="{% url 'add_project' %}">Create Project</a>
{% endif %}

{% if user_projects %}
<a class="btn btn-primary" href="{% url 'add_response' issue_pk=issue.pk %}">Link Project</a>
{% endif %}

</div>
</div>

{% endblock %}
